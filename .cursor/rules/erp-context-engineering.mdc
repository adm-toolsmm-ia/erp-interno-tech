---
alwaysApply: true
description: "Regras de Context Engineering para ERP Interno Tech IA-Ready"
---

# ü§ñ Context Engineering - ERP Interno Tech

## Regras Fundamentais para IA

### 1. **Audit Fields Obrigat√≥rios**
Todos os modelos Prisma DEVEM ter campos de auditoria:
```prisma
model BaseModel {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?  // ID do usu√°rio que criou
  updatedBy String?  // ID do usu√°rio que atualizou
}
```

### 2. **Multi-Tenancy Rigorosa**
- **TODAS** as opera√ß√µes devem incluir `empresaId`
- **TODAS** as APIs devem retornar `tenantId` no meta
- **TODAS** as queries devem filtrar por tenant

### 3. **JSON Autodocumentado**
Toda resposta de API deve seguir o padr√£o:
```json
{
  "data": { /* dados da resposta */ },
  "meta": {
    "tenantId": "empresa-123",
    "requestId": "req-456",
    "timestamp": "2025-01-03T17:14:25Z",
    "version": "1.0.0"
  }
}
```

### 4. **Seeds Versionados**
- Seeds em CSV + Markdown explicativo
- Versionamento sem√¢ntico dos seeds
- Documenta√ß√£o de classifica√ß√£o para IA

### 5. **Fluxos em Mermaid**
- **TODOS** os fluxos de neg√≥cio em diagramas Mermaid
- Versionamento dos diagramas
- Integra√ß√£o com documenta√ß√£o de dom√≠nio

## Regras de Context Engineering

### 6. **Context Injection**
- Documenta√ß√£o por dom√≠nio em `docs/03-domains/`
- Prompts modulares em `docs/02-prompts.md`
- Personas de agentes em `docs/04-agentes.md`

### 7. **Observabilidade IA**
- Logs de contexto (n√£o apenas erros de c√≥digo)
- M√©tricas de uso de prompts
- Tracking de decis√µes de agentes

### 8. **Versionamento de Contexto**
- Changelog de mudan√ßas de contexto
- Versionamento de prompts
- Hist√≥rico de decis√µes de arquitetura

## Regras de Seguran√ßa IA

### 9. **Valida√ß√£o de Contexto**
- Valida√ß√£o de prompts antes de execu√ß√£o
- Sanitiza√ß√£o de inputs de agentes
- Auditoria de a√ß√µes de IA

### 10. **Controle de Acesso**
- Agentes t√™m escopo limitado por dom√≠nio
- Valida√ß√£o de permiss√µes por persona
- Logs de acesso por agente

## Regras de Performance

### 11. **Otimiza√ß√£o de Contexto**
- Carregamento lazy de contexto por dom√≠nio
- Cache de prompts frequentes
- Compress√£o de contexto para agentes

### 12. **M√©tricas de Contexto**
- Tempo de carregamento de contexto
- Taxa de sucesso de prompts
- Qualidade de respostas de agentes

## Regras de Manutenibilidade

### 13. **Documenta√ß√£o Viva**
- Atualiza√ß√£o autom√°tica de contexto
- Sincroniza√ß√£o com c√≥digo
- Valida√ß√£o de consist√™ncia

### 14. **Testes de Contexto**
- Testes de prompts
- Valida√ß√£o de respostas de agentes
- Testes de integra√ß√£o de contexto

## Regras de Escalabilidade

### 15. **Modularidade**
- Contexto por dom√≠nio independente
- Prompts reutiliz√°veis
- Agentes especializados

### 16. **Extensibilidade**
- F√°cil adi√ß√£o de novos dom√≠nios
- Plugins de contexto
- APIs de contexto para terceiros